var that;sap.ui.define(["./ValueHelpExt.controller","./ValueHelpBpClienteExt.controller","./ValueHelpModalidaFreteExt.controller","./ValueHelpAgenteFreteExt.controller","sap/ui/comp/library","sap/ui/core/mvc/Controller","sap/ui/model/type/String","sap/m/+
ColumnListItem","sap/m/Label","sap/m/SearchField","sap/m/Token","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/odata/v2/ODataModel","sap/ui/table/Column","sap/m/Column","sap/m/Text"],function(e,t,a,n,o,i,s,l,r,u,p,g,c,h,d,m,f){"use str+
ict";return{onInit:function(){that=this},gravaMotivo:function(e){var t=that.getView().getModel("i18n").getResourceBundle();var a=e.getBindingContext();var n=e.getValue();if(a.getObject().MaterialDocumentRetorno!=""){sap.m.MessageBox.warning(t.getText("ms+
gErroCampoEditavel"));return null}var o=function(){return new Promise(function(e,t){that.extensionAPI.invokeActions("/motivo",a,{motivoparam:n}).then(function(t){e();that.templateBaseExtension.getExtensionAPI().refreshTable();that.getView().getModel().re+
fresh()}).catch(function(e){t()})})};var i={busy:{set:true,check:false},dataloss:{popup:false,navigation:false}};this.extensionAPI.securedExecution(o,i)},gravaQtdReceb:function(e){var t=that.getView().getModel("i18n").getResourceBundle();let a=e.getBindi+
ngContext().getObject();let n=this.templateBaseExtension.getExtensionAPI().getSelectedContexts();let o=e.getValue();let i=n.filter(e=>e.getObject().MaterialDoc===a.MaterialDoc&&e.getObject().MaterialDocItem===a.MaterialDocItem&&e.getObject().MaterialDocY+
ear===a.MaterialDocYear);if(o>i[0].getObject().QtdReceb){e.setValue(i[0].getObject().QtdReceb);sap.m.MessageBox.warning(t.getText("msgErroCampoEditavelPOPUP"));return null}},onChangeMotivo:function(e){let t=e.getSource();this.gravaMotivo(t)},onChangeQtdR+
eceb:function(e){let t=e.getSource();that.gravaQtdReceb(t)},onChangeQuantidade:function(e){var t=that.getView().getModel("i18n").getResourceBundle();var a=e.getSource();var n=e.getSource().getBindingContext();var o=parseFloat(a.getValue());if(n.getObject+
().MaterialDocumentRetorno!=""){sap.m.MessageBox.warning(t.getText("msgErroCampoEditavel"));return null}var i=function(){return new Promise(function(e,t){that.extensionAPI.invokeActions("/descarga",n,{descarga:o}).then(function(t){e();that.templateBaseEx+
tension.getExtensionAPI().refreshTable();that.getView().getModel().refresh()}).catch(function(e){t()})})};var s={busy:{set:true,check:false},dataloss:{popup:false,navigation:false}};this.extensionAPI.securedExecution(i,s)},GerarRetornoArm:function(e,t){v+
ar a=sap.ui.getCore().byId("inBpCliente").getValue();var n=sap.ui.getCore().byId("inModalidadeFrete").getValue();var o=sap.ui.getCore().byId("inAgentedeFrete").getValue();var i=sap.ui.getCore().byId("inPlaca").getValue();var s=sap.ui.getCore().byId("inIn+
foDanfe").getValue();let l=this.templateBaseExtension.getExtensionAPI();let r=t.oModels.undefined.oData;let u=0;var p=function(){return new Promise(function(e,t){for(let e of l.getSelectedContexts()){var p=[];var g=new Promise(function(t,l){that.extensio+
nAPI.invokeActions("/gerar_retorno",e,{InfoDanfe:s,Placa:i,ModalidadeFrete:n,AgenteFrete:o,BpCliente:a,QtdRes:r[u].QtdReceb}).then(function(e){t();that.templateBaseExtension.getExtensionAPI().refreshTable();that.getView().getModel().refresh()}).catch(fun+
ction(e){l()})});p.push(g);u++}Promise.all(p).then(function(t){e();that.templateBaseExtension.getExtensionAPI().refreshTable();that.getView().getModel().refresh()}).catch(function(e){t()})})};var g={busy:{set:true,check:false},dataloss:{popup:false,navig+
ation:false}};this.extensionAPI.securedExecution(p,g)},onGerarRetornoArm:function(e){this.classe=this;var t=that.getView().getModel("i18n").getResourceBundle();let a=this.templateBaseExtension.getExtensionAPI();var n=this.getView().getModel();let o=this.+
templateBaseExtension.getExtensionAPI().getSelectedContexts();let i=a.getSelectedContexts()[0].getObject().BusinessPartner;var s=new sap.ui.layout.VerticalLayout({width:"100%",content:[new sap.m.Label({text:t.getText("LblBpCliente")}),new sap.m.Input("in+
BpCliente",{width:"100%",maxLength:10,value:i,showValueHelp:true,valueHelpRequest:()=>{that.valueHelpBpCliente(that)}}),new sap.m.Label({text:t.getText("LblModalidadeFrete")}),new sap.m.Input("inModalidadeFrete",{width:"100%",maxLength:1,showValueHelp:tr+
ue,valueHelpRequest:()=>{that.ValueHelpModalidaFrete(that)}}),new sap.m.Label({text:t.getText("LblAgentedeFrete")}),new sap.m.Input("inAgentedeFrete",{width:"100%",maxLength:10,showValueHelp:true,valueHelpRequest:()=>{that.valueHelpAgente(that)}}),new sa+
p.m.Label({text:t.getText("LblPlaca")}),new sap.m.Input("inPlaca",{width:"100%",maxLength:7,showValueHelp:false})]});var l=new sap.m.Table({inset:false,headerToolbar:new sap.m.Toolbar({content:[new sap.m.Title({text:t.getText("LblTitulo")})]}),columns:[n+
ew sap.m.Column({header:new sap.m.Label({text:t.getText("LblNfeRemessa")}),width:"20%"}),new sap.m.Column({header:new sap.m.Label({text:t.getText("LblMaterial")})}),new sap.m.Column({header:new sap.m.Label({text:t.getText("LblQuantidade")}),hAlign:"Right+
"})]});var r=new sap.m.ColumnListItem({cells:[new sap.m.ObjectStatus({text:"{NfeRemessa}",state:"{= ${PerdaGanho} < 0 ? 'Error' : 'Success' }"}),new sap.m.ObjectStatus({text:"{Material} - {MaterialName}",state:"{= ${PerdaGanho} < 0 ? 'Error' : 'Success' +
}"}),new sap.m.Input({value:"{QtdReceb}",editable:true,textAlign:"Right",change:that.onChangeQtdReceb})]});l.bindAggregation("items",{path:"/",template:r});l.setModel(new sap.ui.model.json.JSONModel(o.map(e=>e.getObject())));var u=new sap.m.ScrollContain+
er({vertical:true,height:"300px",content:l});s.addContent(u);s.addContent(new sap.m.Label({text:t.getText("LblInfoDanfe")}));s.addContent(new sap.m.TextArea("inInfoDanfe",{width:"100%",rows:5}));var p=new sap.m.Dialog({type:"Message",title:t.getText("Btn+
GerarRetorno"),resizable:true,draggable:true,titleAlignment:sap.m.TitleAlignment.Left,content:s,beginButton:new sap.m.Button({type:sap.m.ButtonType.Emphasized,text:t.getText("BtnGerarRetorno"),press:async function(){var t=await that.GerarRetornoArm(e,l);+
p.close();p.destroy()}}),endButton:new sap.m.Button({text:t.getText("LblCancelar"),press:function(){p.close()}}),afterClose:function(){p.destroy()},contentWidth:"50%"});p.open()},onEstorno:function(e){var t=this.getView().getModel("i18n").getResourceBund+
le();let a=this.templateBaseExtension.getExtensionAPI();let n=this.templateBaseExtension.getExtensionAPI().getSelectedContexts();if(n.length>1){sap.m.MessageBox.warning(t.getText("txtSingleLine"));return}var o,i,s,l;for(let e of a.getSelectedContexts()){+
o=e.getObject().BR_NotaFiscal;i=e.getObject().Empresa;s="";l=""}var r="NotaFiscal";var u="monitor";var p={Docnum:o,Bukrs:i,DataDocInicio:s,DataDocFim:l};this.navigateTo(r,u,p)},navigateTo:function(e,t,a){sap.ushell.Container.getService("CrossApplicationN+
avigation").isNavigationSupported([{target:{shellHash:e+"-"+t}}]).done(function(n){n.map(function(n,o){if(n.supported===true){var i=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{s+
emanticObject:e,action:t},params:a});sap.m.URLHelper.redirect(i,false)}else{sap.m.MessageBox.warning("Usuário sem permissão para acessar o link")}})}).fail(function(){sap.m.MessageBox.error("Falha ao acessar o link")})},valueHelpMotivo:function(t){this._+
oInputMotivo=t;this.pWhitespaceDialog=new e.valueHelpContruct(t,this)},valueHelpBpCliente:function(e){this._oInputUfDestino=sap.ui.getCore().byId("inBpCliente");this.pWhitespaceDialog=new t.valueHelpContruct(e)},valueHelpAgente:function(e){this._oInputUf+
Destino=sap.ui.getCore().byId("inAgentedeFrete");this.pWhitespaceDialog=new n.valueHelpContruct(e)},ValueHelpModalidaFrete:function(e){this._oInputUfDestino=sap.ui.getCore().byId("inModalidadeFrete");this.pWhitespaceDialog=new a.valueHelpContruct(e)},onV+
alueHelpDialogOk:function(e){let t=this.pWhitespaceDialog.ValueHelpDialogOk(e);this.gravaMotivo(t)},onValueHelpDialogPopUpRetornoRemessaOk:function(e){var t=this.pWhitespaceDialog.ValueHelpDialogOk(e);this._oInputUfDestino.setValue(t)},onValueHelpDialogC+
ancel:function(e){this.pWhitespaceDialog.ValueHelpDialogCancel()},onFilterBarSearch:function(e){this.pWhitespaceDialog.Search(e)},onInputSuggestionItemSelected:function(e){this.pWhitespaceDialog.SuggestionItemSelected(e)}}});                              
//# sourceMappingURL=ListReportExt.controller.js.map                                                                                                                                                                                                           